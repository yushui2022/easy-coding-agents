导致乱码和 ANSI 代码直接显示的原因通常有两个：

1.  **编码不匹配 (Mojibake)**: Windows 终端默认可能是 GBK，而 Python 输出 UTF-8，导致中文变成乱码。
2.  **ANSI 转义序列未解析**: Windows 旧版控制台（或某些配置下的 PowerShell）默认不解析 VT100 颜色代码，直接把 `←[32m` 这种字符打印出来了。

我将采取双重保险的修复方案：

## 修复计划

### 1. 修改启动脚本 (`run_agent.bat`)
*   **动作**: 添加 `chcp 65001` 命令。
*   **作用**: 强制将当前控制台的代码页切换为 UTF-8，解决中文字符乱码。
*   **动作**: 设置环境变量 `PYTHONIOENCODING=utf-8`。
*   **作用**: 告诉 Python 解释器明确使用 UTF-8 进行输入输出。

### 2. 代码级强制开启 VT100 (`utils/logger.py`)
*   **动作**: 添加 `os.system('')` 这个黑魔法。
*   **作用**: 在 Windows 上，这行看似无用的代码实际上会触发 `cmd.exe` 去初始化终端的 VT100 仿真模式，从而让 ANSI 颜色代码被正确渲染，而不是直接显示出来。

这个方案仅涉及两个文件的微小改动，风险极低，但能有效解决显示问题。准备好后请确认。